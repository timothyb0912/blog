<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>On Priors for Neural Networks | Timothy Brathwaite</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="On Priors for Neural Networks" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A review of two research papers pointing to the need for carefully chosen priors for one’s neural networks." />
<meta property="og:description" content="A review of two research papers pointing to the need for carefully chosen priors for one’s neural networks." />
<link rel="canonical" href="https://timothyb0912.github.io/blog/reading/2020/07/29/Neural-Net-Priors.html" />
<meta property="og:url" content="https://timothyb0912.github.io/blog/reading/2020/07/29/Neural-Net-Priors.html" />
<meta property="og:site_name" content="Timothy Brathwaite" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-07-29T00:00:00-05:00" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"https://timothyb0912.github.io/blog/reading/2020/07/29/Neural-Net-Priors.html"},"url":"https://timothyb0912.github.io/blog/reading/2020/07/29/Neural-Net-Priors.html","@type":"BlogPosting","headline":"On Priors for Neural Networks","dateModified":"2020-07-29T00:00:00-05:00","datePublished":"2020-07-29T00:00:00-05:00","description":"A review of two research papers pointing to the need for carefully chosen priors for one’s neural networks.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://timothyb0912.github.io/blog/feed.xml" title="Timothy Brathwaite" /><link rel="shortcut icon" type="image/x-icon" href="/blog/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/blog/">Timothy Brathwaite</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blog/about/">About Me</a><a class="page-link" href="/blog/search/">Search</a><a class="page-link" href="/blog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">On Priors for Neural Networks</h1><p class="page-description">A review of two research papers pointing to the need for carefully chosen priors for one's neural networks.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-07-29T00:00:00-05:00" itemprop="datePublished">
        Jul 29, 2020
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      7 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/blog/categories/#reading">reading</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h1"><a href="#on-priors-for-neural-networks">On Priors for Neural Networks</a>
<ul>
<li class="toc-entry toc-h3"><a href="#helpful-priors-from-frequentists">Helpful priors from Frequentists</a></li>
<li class="toc-entry toc-h3"><a href="#harmful-priors-from-bayesians">Harmful priors from Bayesians</a></li>
<li class="toc-entry toc-h3"><a href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul><h1 id="on-priors-for-neural-networks">
<a class="anchor" href="#on-priors-for-neural-networks" aria-hidden="true"><span class="octicon octicon-link"></span></a>On Priors for Neural Networks</h1>

<p>Dear Young Tim,</p>

<p>I hope this note reaches you long before you need it.
At some point, you will want to experiment with neural networks.
And when you do, you will want to learn both how they work and how you can make them work well.
Essentially, this means learning how to design (i) likelihoods, i.e. neural network architectures and activations, (ii) priors, i.e. regularization schemes, and (iii) training / inference procedures.</p>

<p>In this post, I offer you an opinionated introduction to constructing and using neural networks.
I come to you as a sort of statistical, Mardi Gras Indian, <a href="https://www.mardigrasneworleans.com/history/mardi-gras-indians/ranks">Spy Boy</a>.
Indeed, I have scouted ahead and brought back strange reports of success and despair.</p>

<p>I know our procession is a Bayesian one, a practical and practicing one at that.
Accordingly, like any thorough Bayesian model, this story begins with the prior.
Not with the main character, the likelihood, the neural network itself.
But instead with the background, the prior, the context through which we regularize and understand the entire drama.</p>

<p>In time, you will find that training often becomes easier with a good prior and that using the prior predictive distribution is a great way to understand neural architectures.
You will learn that the fastest way to create neural networks that generalize well is to use good priors during training, and you will spend a lot of time and computational resources figuring out how to do so.
This post aims to provide you with a framework for thinking about priors / regularization for neural networks.
In the end this framework should save you much time, computation, and confusion, but at the moment, let’s begin with the basics.</p>

<h3 id="helpful-priors-from-frequentists">
<a class="anchor" href="#helpful-priors-from-frequentists" aria-hidden="true"><span class="octicon octicon-link"></span></a>Helpful priors from Frequentists</h3>
<p>The first report I have for you is that Frequentists who build neural networks care <strong>a lot</strong> about neural network priors.
Moreover, Frequentists are commonly successful at constructing priors that enable them to achieve impressive out-of-sample performance.</p>

<p>Yes, of course, you didn’t expect to see such concerns from Frequentists… I know.
If it’s any consolation, it’s July 2020 for me.
By this point, after the coronavirus pandemic, after the global recession, after the continued racism… little will surprise you anymore.
But for now, soak it all in.</p>

<p>To start with, Frequentists will not speak of prior distributions when describing how they construct their neural networks.
Instead, they will equivalently speak of regularization methods.
However, have no fear.
As discussed below, most regularization methods have explicit counterparts in Bayesian priors.</p>

<p>For example, placing a mean zero Gaussian prior over one’s weights (i.e. neural network parameters) leads to L2-weight decay (see Table 1, p.2821 <a href="http://www.yaroslavvb.com/papers/chen-on.pdf">here</a>).
Similarly, placing a mean zero <a href="https://www.researchgate.net/profile/Peter_Williams19/publication/2719575_Bayesian_Regularisation_and_Pruning_using_a_Laplace_Prior/links/58fde123aca2728fa70f6aab/Bayesian-Regularisation-and-Pruning-using-a-Laplace-Prior.pdf">Laplace prior</a> over one’s weights leads to L1-weight decay.
Perhaps less familiarly, data augmentation is also a way encoding prior information (see for example, <a href="http://cbcl.mit.edu/publications/ps/niyogi_poggio_girosi_1998.pdf">here</a> and <a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/sim.902">here</a>).
And so on, and so forth.
Stay tuned for future posts that provide a more comprehensive list of such comparisons.</p>

<p>For now, it suffices to say that much research on designing good regularization methods for deep learning is implicitly about designing good priors for one’s neural networks.
And this brings us to today’s first paper of interest.
<code class="language-plaintext highlighter-rouge">Do Deep Nets Really Need to be Deep?</code> by Ba and Carauna (<a href="https://arxiv.org/abs/1312.6184">2014</a>).</p>

<p>Ba and Carauna’s paper is one of the first to introduce the concept of knowledge/model distillation: taking the knowledge obtained from a given model, called the teacher, and passing that knowledge to a second model, called the student.
The teacher packages its knowledge using predictions (or intermediate quantities) on the dataset used to train the student model.
A regularization term is then used to penalize the student model for deviations between its predictions or intermediate quantities and those of the teacher.
As one might expect given the preceding discussion about regularization often equaling prior specification, placing a prior on the divergence of your neural network’s predictions from those of a teacher’s predictions leads to model distillation.
See <a href="https://www.tandfonline.com/doi/abs/10.1080/01621459.1996.10476713">here</a> for historical examples of such priors on predictive functionals in statistics using “human expert teachers,” and see <a href="https://arxiv.org/pdf/1912.00874.pdf">here</a> for a modern bayesian perspective on model distillation.</p>

<p>The important findings from Ba and Carauna’s paper are the following.</p>
<blockquote>
  <p>“[M]odels trained on targets predicted by other models can be more accurate than models trained on the original labels” (p. 6)</p>
</blockquote>

<blockquote>
  <p>“The mechanisms above can be seen as forms of regularization that help prevent overfitting in the student model” (p. 7)</p>
</blockquote>

<blockquote>
  <p>“Although there is a consistent performance gap between the two models due to the difference in size, the smaller shallow model was eventually able to achieve a performance comparable to the larger shallow net by learning from a better teacher, and the accuracy of both models continues to increase as teacher accuracy increases. […] We see little evidence that shallow models have limited capacity or representational power. Instead, the main limitation appears to be the learning and regularization procedures used to train the shallow models.” (pp. 7-8)</p>
</blockquote>

<p>Or, put differently, the provision of a good prior (in this paper, an accurate teacher model and choice of penalization function)</p>
<ul>
  <li>can be even more important for neural network performance than providing access to the real data (see also <a href="https://www.aaai.org/ocs/index.php/AAAI/AAAI17/paper/view/14967/14447">here</a>),</li>
  <li>helps prevent overfitting, and</li>
  <li>might be the primary missing factor needed to construct performant neural networks (at least for some network classes).</li>
</ul>

<h3 id="harmful-priors-from-bayesians">
<a class="anchor" href="#harmful-priors-from-bayesians" aria-hidden="true"><span class="octicon octicon-link"></span></a>Harmful priors from Bayesians</h3>
<p>My second report is that Bayesians have been building neural networks with priors that do more harm than good.</p>

<p>One of the most recent clarion calls was Wenzel et al.’s <code class="language-plaintext highlighter-rouge">How Good is the Bayes Posterior in Deep Neural Networks Really?</code> (<a href="https://arxiv.org/abs/2002.02405">2019</a>).
Wenzel et al.’s motivating observation was that, in the papers they considered and in their experience, tempering the posterior distribution often led to better predictive performance compared to using the actual posterior distribution.
The authors view the lackluster performance of the true posterior distribution as a problem because it suggests problems with the likelihood, prior, or training procedure.</p>

<p>To investigate the sources of the posterior distribution’s dismal performance, Wenzel et al. perform a series of computational experiments.
Based on these trials, the authors assign high probability to the posterior distribution’s underperformance being due to the prior distributions used with Bayesian neural networks, as opposed to the likelihood or training procedures.</p>

<p>In particular, the authors look at a standard, multivariate normal distribution prior (i.e., L2-weight decay).
First, they find that with an increasing number of parameters, the standard normal prior leads to unintentially informative prior predictive distributions.
They uncover prior predictive distributions that are much more extreme than desired.</p>

<p>Second, the authors realize that as they decrease the number of observations in their training set, the predictive performance of their posterior distribution degrades faster than the predictive performance of the maximum likelihood estimate (which implicitly assumes an improper uniform distribution).
Since the effect of the prior increases as one decreases the number of observations, this indicates that the standard normal prior is worse than the improper uniform prior in the settings they considered.
For yet another example of problems arising from using the standard normal prior with neural networks, see the “soap-bubble pathology” (<a href="https://arxiv.org/pdf/1907.00865.pdf">Farquhar et al., 2019</a>).</p>

<p>These observations all stand as examples of “the <a href="https://statmodeling.stat.columbia.edu/2013/11/21/hidden-dangers-noninformative-priors/">hidden dangers</a> of noninformative priors” or default priors.
Researchers often adopt such priors for computational or political ease, but they may have deleterious effects on one’s posterior performance and inference.
In fact, one should perhaps expect such negative consequences given the typical, over-parameterized neural network context with a high ratio of parameters to one’s number of observations.</p>

<h3 id="conclusion">
<a class="anchor" href="#conclusion" aria-hidden="true"><span class="octicon octicon-link"></span></a>Conclusion</h3>
<p>The papers <code class="language-plaintext highlighter-rouge">How Good is the Bayes Posterior in Deep Neural Networks Really?</code> and <code class="language-plaintext highlighter-rouge">Do Deep Nets Really Need to be Deep?</code> show that prior distributions are important to neural network construction.
These papers show that priors can have either helpful or harmful effects on one’s predictive ability, relative to maximum likelihood estimation.
To give oneself the best chance of constructing neural networks that perform well, and to reduce the chance of having our predictive performance harmed unnecessarily, the takeaway is that we should carefully choose the priors for our models.</p>

  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="timothyb0912/blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/blog/reading/2020/07/29/Neural-Net-Priors.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="https://timothyb0912.github.io/blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>A personal blog.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li>
  <a rel="me" href="https://twitter.com/timothyb0912" target="_blank" title="twitter">
    <svg class="svg-icon grey">
      <use xlink:href="/blog/assets/minima-social-icons.svg#twitter"></use>
    </svg>
  </a>
</li>
<li>
  <a rel="me" href="https://github.com/timothyb0912/" target="_blank" title="github">
    <svg class="svg-icon grey">
      <use xlink:href="/blog/assets/minima-social-icons.svg#github"></use>
    </svg>
  </a>
</li>
</ul>
</div>

  </div>

</footer>
</body>

</html>
